- [第三节 泰勒公式](#第三节-泰勒公式)
  - [一、问题的提出](#一问题的提出)
    - [忆往昔峥嵘岁月稠](#忆往昔峥嵘岁月稠)
    - [惜秦皇汉武略输文采唐宗宋祖稍逊风骚](#惜秦皇汉武略输文采唐宗宋祖稍逊风骚)
    - [上下求索](#上下求索)
  - [二、泰勒公式](#二泰勒公式)
  - [三、泰勒中值定理](#三泰勒中值定理)
  - [四、一些函数的带有拉格朗日型余项的 $n$ 阶麦克劳林公式](#四一些函数的带有拉格朗日型余项的-n-阶麦克劳林公式)
    - [1. $f(x) = e^x$](#1-fx--ex)
    - [2. $f(x) = \\sin x$](#2-fx--sin-x)
    - [3. $f(x) = \\cos x$](#3-fx--cos-x)
    - [4. $f(x) = \\ln(1+x)$](#4-fx--ln1x)
    - [5. $f(x) = \\ln(1-x)$](#5-fx--ln1-x)
    - [6. $f(x) = (1+x)^{\\alpha}$](#6-fx--1xalpha)

# 第三节 泰勒公式

## 一、问题的提出

### 忆往昔峥嵘岁月稠

由前面学过的函数的微分，

$$
\begin{align}
\Delta y & = f(x_0+\Delta x) - f(x_0) = f'(x_0)\Delta x + o(\Delta x) \\
令 x &=x_0+\Delta x, 则 \Delta x = x- x_0 \\
f(x) & - f(x_0) = f'(x_0)(x-x_0) + o(x-x_0) \\
即 f(x) & = f(x_0)+f'(x_0)(x-x_0) + o(x-x_0) \\
f(x) & \approx f(x_0)+f'(x_0)(x-x_0)
\end{align}
$$

记

$$
P_1(x) = f(x_0)+f'(x_0)(x-x_0)
$$

则 $P_1(x)$ 为关于 $x$ 的一次多项式，且

$$
\begin{align}
P_1(x_0) & = f(x_0) \\
P_1'(x_0) & = f'(x_0)
\end{align}
$$

即 $P_1(x)$ 与 $f(x)$ 在 $x_0$ 点的函数值相等，导数值也相等.

即用切线 $P_1(x)$ 近似代替曲线 $f(x)$ .

### 惜秦皇汉武略输文采唐宗宋祖稍逊风骚

但这种近似有两个不足：

1. 精度不高，仅为 $(x-x_0)$ 的高阶无穷小
2. 误差不能进行估计

### 上下求索

鉴于以上，提出：

设 $f(x)$ 有直到 $(n+1)$ 阶导数，找一个 $n$ 阶多项式 $P_n(x)$，使 $f(x)$ 与 $P_n(x)$ 在点 $x_0$ 处，函数值、各阶导数值均相等（直到 $n$ 阶）.

用 $P_n(x)$ 近似代替 $f(x)$，问

1. $P_n(x)$ 是否存在？
2. $P_n(x)$ 的精度如何？
3. 对误差 $R_n(x) = f(x)-P_n(x)$如何进行估计？

## 二、泰勒公式

记

$$
P_n(x) = a_0 + a_1(x-x_0) + a_2(x-x_0)^2 + \cdots + a_n(x-x_0)^n
$$

要求：

$$
\begin{cases}
P_n(x_0) & = f(x_0) \\
p_n'(x_0) & = f'(x_0) \\
P_n''(x_0) & = f''(x_0) \\
\cdots \\
P_n^{(n)}(x_0) & = f^{(n)}(x_0)
\end{cases}
$$

现在：

$$
\begin{cases}
P_n(x_0) & = a_0 \\
P_n'(x_0) & = a_1 \\
P_n''(x_0) & = 2!a_2 \\
\cdots \\
P_n^{(n)}(x_0) & = n!a_n
\end{cases}
$$

解出 $a_0, a_1, \cdots, a_n$：

$$
\begin{cases}
a_0 & = f(x_0) \\
a_1 & = f'(x_0) \\
a_2 & = \frac 1 {2!} f''(x_0) \\
\cdots \\
a_n & = \frac 1 {n!} f^{(n)}(x_0)
\end{cases}
$$

得到**泰勒多项式**：

$$
P_n(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + \cdots + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n
$$

## 三、泰勒中值定理

如果 $f(x)$ 在包含 $x_0$ 在内的开区间 $(a,b)$ 内有 $(n+1)$ 阶导数，则对于任一 $x\in(a,b)$，有

$$
\begin{align}
f(x) & = P_n(x) + R_n(x) \\
& = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + \cdots + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n + R_n(x)
\end{align}
$$

其中，

$$
R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
$$

$\xi$ 是介于 $x_0$ 与 $x$ 之间的某个值.

上式称为 $f(x)$ 在 $x_0$处（或按 $(x-x_0)$ 的幂展开）的**带有拉格朗日余项的** $n$ **阶泰勒公式**，而 $R_n$ 称为**拉格朗日余项**.

当 $n=0$ 时，上式变为

$$
f(x)=f(x_0) + f'(\xi)(x-x_0), \xi \in (x_0, x)
$$

退化成了拉格朗日中值公式，因此，泰勒中值定理是拉格朗日中值定理的推广.

**证明** $R_n(x)=f(x)=P_n(x)$

要证

$$
R_n(x) = \frac{f^{(n+1)}(x_0)}{(n+1)!}(x-x_0)^{n+1}
$$

即

$$
\frac{R_n(x)}{(x-x_0)^{n+1}} = \frac{f^{(n+1)}(x_0)}{(n+1)!}
$$

而

$$
\begin{cases}
R_n(x_0) & = 0 \\
R_n'(x_0) & = 0 \\
\cdots \\
R_n^{(n)}(x_0) & = 0
\end{cases}
$$

由于 $f(x)$ 有 $(n+1)$ 阶导, $P_n(x)$ 为多项式有无穷多阶导（实际到 $(n)$ 阶就是常数了， 到 $(n+1)$ 阶就是零），所以 $R_n(x)$ 有 $(n+1)$ 阶导，则由柯西中值定理，

$$
\begin{align}
\frac{R_n(x)}{(x-x_0)^{n+1}} & = \frac{R_n(x) - R_n(x_0)}{(x-x_0)^{n+1}-(x_0-x_0)^{n+1}} \\
& = \frac{R_n'(\xi_1)}{(n+1)(\xi_1-x_0)^n}
\end{align}
$$

$\xi_1$ 介于 $x_0, x$ 之间.

而

$$
\begin{align}
\frac{R_n'(\xi_1)}{(n+1)(\xi_1-x_0)^n} & = \frac{R_n'(\xi_1) - R_n'(x_0)}{(n+1)(\xi_1-x_0)^n - (n+1)(x_0-x_0)^n} \\
& = \frac{R''(\xi_2)}{(n+1)n(\xi_2-x_0)^{n-1}}
\end{align}
$$

$\xi_2$ 介于 $x_0, \xi_1$ 之间.

以此类推，得

$$
\frac{R_n^{(n)}(\xi_n)}{(n+1)!(\xi_n-x_0)} = \frac{R_n^{(n+1)}(\xi)}{(n+1)!\xi}
$$

$\xi$ 介于 $x_0, \xi_n$ 之间. 注意到

$$
R_n^{(n+1)}(x) = f^{(n+1)}(x) - P_n^{(n+1)}(x)
$$

而 

$$
P_n^{(n+1)} = 0
$$

因此,

$$
\frac{R_n(x)}{(x-x_0)^{n+1}} = \frac{f^{(n+1)}(\xi)}{(n+1)!}
$$

$\xi$ 介于 $x_0, x$ 之间.

得到

$$
R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
$$

证毕.


## 四、一些函数的带有拉格朗日型余项的 $n$ 阶麦克劳林公式

### 1. $f(x) = e^x$

因为

$$
f'(x) = f''(x) = \cdots = f^{(n)}(x) = e^x
$$

所以

$$
f(0) = 0, f'(0) = f''(0) = \cdots = f^{(n)}(0) = 1,
$$

代入麦克劳林公式

$$
f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x + \cdots + \frac{f^{(n)}(0)}{n!}x^n + R_n(x)
$$

其中

$$
R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}x^{n+1}, \xi 介于 0 和 x 之间
$$

得到

$$
e^x = 1 + x + \frac{x^2}{2!} + \cdots + \frac{x^n}{n!} + \frac{x^{n+1}}{(n+1)!}e^{\theta x}, (0\lt \theta \lt 1)
$$

### 2. $f(x) = \sin x$

因为

$$
f'(x) = \cos x, f''(x) = -\sin x, f'''(x) = -\cos x, f^{(4)} = \sin x, \cdots, f^{(n)} = \sin(x+\frac{n\pi}2)
$$

所以

$$
f(0) = 0, f'(0) =1, f''(0) = 0, f'''(0) = -1, f^{(4)} = 0
$$

它们顺序循环地取四个数 $0,1,0,-1$

按麦克劳林公式

$$
f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x + \cdots + \frac{f^{(n)}(0)}{n!}x^n + R_n(x)
$$

其中

$$
R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}x^{n+1}, \xi 介于 0 和 x 之间
$$

令 $n=2m$

$$
\begin{align}
\sin x & = 0 + x + 0 - \frac{x^3}{3!} + 0 + \frac{x^5}{5!} + 0 - \frac{x^7}{7!} + 0 + \frac{x^9}{9!} + \cdots + (-1)^{m-1}\frac{x^{2m-1}}{(2m-1)!} + 0 + R_{2m} \\
& = x-\frac{x^3}{3!}+\frac{x^5}{5!}-\frac{x^7}{7!}+\frac{x^9}{9!} + \cdots + (-1)^{m-1}\frac{x^{2m-1}}{(2m-1)!} + R_{2m}(x)
\end{align}
$$

其中

$$
\begin{align}
R_{2m} & = \frac{\sin[\theta x + (2m+1)\frac \pi 2]}{(2m+1)!}x^{2m+1} \\
& = (-1)^m\frac{\cos \theta x}{(2m+1)!}x^{2m+1}, (0\lt \theta \lt 1)
\end{align}
$$

至于为什么是 $(-1)^{m-1}$，个人理解是从 $(2m-1)$ 反推的。

因为偶数项为0，只有奇数项，通项只能写 $(2m-1)$，而且要保证去掉0项之后重新计数的奇数项为正，偶数项为负，就是 $(-1)^{m-1}$

### 3. $f(x) = \cos x$

因为

$$
f'(x) = -\sin x, f''(x) = -\cos x, f'''(x) = \sin x, f^{(4)}(x) = \cos x, f^{(5)} = -\sin x, \cdots, f^{(n)}(x) = \cos(x+\frac{n\pi}2)
$$

所以

$$
f(0) = 1, f'(0) = 0, f''(0) = -1, f'''(0)= 0, f^{(4)}=1, f^{(5)} = 0,
$$

它们的顺序循环地取四个数 $0,-1,0,1$，于是按麦克劳林公式得（令 $n=2m$）

$$
\begin{align}
\cos x &= 1 + 0 - \frac{1}{2!}x^2 + 0 + \frac 1 {4!}x^4 + 0 - \cdots + (-1)^m\frac{1}{(2m)!}x^{2m} + R_{2m+1}(x) \\
& = 1 - \frac 1 {2!}x^2 + \frac 1 {4!}x^4 - \cdots + (-1)^m\frac 1{(2m)!}x^{2m} + R_{2m+1}(x)
\end{align}
$$

其中

$$
\begin{align}
R_{2m+1}(x) & = \frac{\cos[\theta x + (m+1)\pi]}{(2m+2)!}x^{2m+2} \\
& = (-1)^{m+1}\frac{\cos \theta x}{(2m+2)!}x^{2m+2}, (0\lt \theta \lt 1) 
\end{align}
$$

### 4. $f(x) = \ln(1+x)$

由于

$$
f'(x) = \frac {1}{1+x}, f''(x) = -\frac {1}{(1+x)^2}, f'''(x) = \frac {2} {(1+x)^3}, f^{(4)} = -\frac {3!}{(1+x)^4}, \cdots , f^{(n)} = (-1)^{n-1}\frac {(n-1)!}{(1+x)^{n}}
$$

所以

$$
f(0) = 0, f'(0) = 1, f''(0) = -1, f'''(0) = 2, f^{(4)} = -3!, \cdots, f^{(n)}(0) = (-1)^{n-1}(n-1)!
$$

代入麦克劳林公式得

$$
\begin{align}
\ln(1+x) & = 0 + x - \frac 1{2!}x^2 + \frac 2{3!}x^3 - \frac{3!}{4!}x^4 + \cdots + \frac{(-1)^{n-1}(n-1)!}{n!}x^n + R_n(x) \\
& = x-\frac {1}{2}x^2 + \frac 1 3 x^3 - \frac 1 4 x^4 + \cdots + (-1)^{n-1}\frac 1 n x^n + R_n(x)
\end{align}
$$

其中

$$
R_n(x) = \frac{(-1)^n}{(n+1)(1+\theta x)}x^{n+1}, (0\lt \theta \lt 1)
$$

### 5. $f(x) = \ln(1-x)$

由于

$$
f'(x) = -\frac 1{1-x}, f''(x) = -\frac 1{(1-x)^2}, f'''(x) = -\frac 2{(1-x)^3}, f^{(4)} = -\frac{3!}{(1-x)^4}, \cdots, f^{(n)} = -\frac{(n-1)!}{(1-x)^{n}}
$$

所以

$$
f(0) = 0, f'(0) = -1, f''(0) = -1, f'''(0) = -2, f^{(4)} = -3!, \cdots, f^{(n)}(0) = -(n-1)!
$$

代入麦克劳林公式，得

$$
\begin{align}
\ln(1-x) & = 0 - x - \frac 1 {2!} x^2 - \frac {2!}{3!}x^3 + \frac{3!}{4!}x^4 + \cdots + \frac{(n-1)!}{n!}x^n + R_n(x) \\
& = -x-\frac 1 2 x^2 - \frac 1 3 x^3 - \frac 1 4 x^4 - \cdots - \frac 1 n x^n + R_n(x)
\end{align}
$$

其中

$$
\begin{align}
R_n(x) & = \frac{-n!}{(n+1)!(1-\theta x)^{n+1}}x^{n+1} \\
& = \frac {-1} {n(1-\theta x)^{n+1}}x^{n+1}, (0\lt \theta \lt 1)
\end{align}
$$

### 6. $f(x) = (1+x)^{\alpha}$

由于

$$
f'(x) = \alpha(1+x)^{\alpha - 1}, f''(x) = \alpha(\alpha-1)(1+x)^{\alpha-2},f'''(x) = \alpha(\alpha-1)(\alpha-2)(1+x)^{\alpha-3}, \cdots, f^{(n)} = \alpha(\alpha-1)\cdots(\alpha-n+1)(1+x)^{\alpha-n}
$$

所以

$$
f(0) = 1, f'(0) = \alpha, f''(0) = \alpha(\alpha-1), f'''(0) = \alpha(\alpha-1)(\alpha-2) \cdots, f^{(n)}(0) = \alpha(\alpha-1)\cdots(\alpha-n+1)
$$

故

$$
(1+x)^{\alpha} = 1 + \alpha x + \frac{\alpha(\alpha-1)}{2!}x^2 + \frac{\alpha(\alpha-1)(\alpha-2)}{3!}x^3 + \cdots + \frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}x^n + R_n(x)
$$

其中

$$
R_n(x) = \frac{\alpha(\alpha-1)\cdots(\alpha-n)}{(n+1)!}(1+\theta x)^{\alpha-n-1}x^{n+1}, (0\lt \theta \lt 1)
$$
